<launch>
	<group ns="stereo">
		<node pkg="usb_cam" type="usb_cam_node" name="left">
			<param name="video_device" value="/dev/video0"/>
			<param name="camera_frame_id" value="left"/>
			<param name="camera_name" value="left"/>
			<param name="image_width" value="1280"/>
			<param name="image_height" value="1024"/>
			<param name="pixel_format" value="yuyv"/>
			<param name="focus" value="0"/>
			<param name="sharpness" value="255"/>
			<param name="brightness" value="50"/>
			<param name="saturation" value="100"/>
		</node>

		<node pkg="usb_cam" type="usb_cam_node" name="right">
			<param name="video_device" value="/dev/video1"/>
			<param name="camera_frame_id" value="right"/>
			<param name="camera_name" value="right"/>
			<param name="image_width" value="1280"/>
			<param name="image_height" value="1024"/>
			<param name="pixel_format" value="yuyv"/>
			<param name="focus" value="0"/>
			<param name="sharpness" value="255"/>
			<param name="brightness" value="50"/>
			<param name="saturation" value="80"/>
			<param name="exposure_absolute" value="0"/>
		</node>

		<!--node pkg="libuvc_camera" type="camera_node" name="left">
			<remap from="image_raw" to="left/image_raw" />

			<param name="vendor" value="0x05a3"/>
			<param name="product" value="0x9230"/>
			<param name="serial" value="0"/>
			<param name="index" value="0"/>

			<param name="width" value="640"/>
			<param name="height" value="480"/>
			<param name="video_mode" value="uncompressed"/> 
			<param name="frame_rate" value="30"/>
			<param name="camera_info_url" value="file://$(find carrt_goggles)/launch/left.yaml"/>

			<param name="timestamp_method" value="pub"/>
			<param name="frame_id" value="left"/>

			<param name="auto_exposure" value="false"/> 
			<param name="exposure_absolute" value="0.0001"/>
			<param name="brightness" value="-32767" />
		</node-->

		<node pkg="nodelet" type="nodelet" args="standalone image_proc/crop_decimate" name="left_cropper">
			<param name="x_offset" value="150" />
			<param name="y_offset" value="150" />
			<param name="width" value="980" />
			<param name="height" value="724" />

			<!-- remap input topics -->
			<remap from="camera/image_raw" to="left/image_raw"/>
			<remap from="camera/image_info" to="left/camera_info"/>

			<!-- remap output topics -->
			<remap from="camera_out/image_raw" to="left/cropped/image_raw"/>
			<remap from="camera_out/image_info" to="left/cropped/camera_info"/>
		</node>

		<node pkg="nodelet" type="nodelet" args="standalone image_proc/crop_decimate" name="right_cropper">
				<param name="x_offset" value="150" />
			<param name="y_offset" value="150" />
			<param name="width" value="980" />
			<param name="height" value="724" />

			<!-- remap input topics -->
			<remap from="camera/image_raw" to="right/image_raw"/>
			<remap from="camera/image_info" to="right/camera_info"/>

			<!-- remap output topics -->
			<remap from="camera_out/image_raw" to="right/cropped/image_raw"/>
			<remap from="camera_out/image_info" to="right/cropped/camera_info"/>
		</node>

		<node name="stereo_image_proc" pkg="stereo_image_proc" type="stereo_image_proc">
			<remap from="left/image_raw" to="left/cropped/image_raw"/>
			<remap from="left/camera_info" to="left/camera_info"/>
			<remap from="right/image_raw" to="right/cropped/image_raw"/>
			<remap from="right/camera_info" to="right/camera_info"/>
			<param name="approximate_sync" value="True"/>
			
			<param name="speckle_size" value="200"/>
			<param name="min_disparity" value="0"/>
			<param name="disparity_range" value="64"/>
		</node>

		<!--node pkg="carrt_goggles" type="obstacle_detector" name="obstacle_detector" /-->

		<!--node pkg="carrt_goggles" type="ground_plane" name="ground_plane" >
			<param name="visualize" type="bool" value="true" />
		</node-->
	</group>

	<node name="stereo_view" pkg="image_view" type="stereo_view">
		<param name="approximate_sync" value="True"/>
		<remap from="image" to="image_rect_color"/>
	</node>

	<!--node pkg="rviz" type="rviz" name="rviz" args="-d $(find carrt_goggles)/launch/usb_cam.rviz" /-->
</launch>